{% extends 'base.html' %}
{% block title %}
    {% if edit %}
        - Edit Order #{{ form.instance.id }}
    {% else %}
        - New Order
    {% endif %}
{% endblock %}
{% block  content %}
    <div class="row">
        <div class="col-lg-3"></div>
        <div class="col-lg-6 page-title">
            <h1>
                {% if edit %}
                    Edit #{{ form.instance.id }}
                {% else %}
                    Add a New Order
                {% endif %}
            </h1>
        </div>
    </div>
    <div class="menu">
        <ul>
            <li>
                <a onclick="window.history.back(); return false;" >
                    <div class="menu-icon"><i class="fas fa-arrow-left"></i></div>
                    <div class="menu-text">Back</div>
                </a>
            </li>
            <li>
                <a href="">
                    <label for="submit-form">
                        <div class="menu-icon"><i class="far fa-save" aria-hidden="true"></i></div>
                        <div class="menu-text">Save</div>
                    </label>
                </a>
            </li>
        </ul>

    </div>

    <div class="row"></div>
    <div class="row">
    <div class="col-lg-2"></div>
        <form class="new-client-form" action="" method="POST">
            {% csrf_token %}
            <div class="col-lg-3">
                <div class="input-group ui-widget">
                    <span>{{ form.clientID.label_tag }}</span>
                    <span style="display: none;">{{ form.clientID }}</span>
                    {% if edit %}
                        <span>{{ form.instance.clientID.name }}</span>
                    {% else %}
                        <input id="autocomplete-clients">

                    {% endif %}
                </div>
                <div class="input-group">
                    <span>{{ form.dueDate.label_tag }}</span>
                    {{ form.dueDate }}

                </div>
                <div class="input-group">
                    <span>{{ form.products.label_tag }}</span>
                    {{ form.products }}
                </div>
            </div>
                <div class="input-group">
                    <span>{{ form.processes.label_tag }}</span>
                    {{ form.processes }}
                </div>
                <div class="input-group">
                    <span>{{ form.remarks.label_tag }}</span>
                    {{ form.remarks }}
                </div>
                <input type="submit" id="submit-form" class="hidden">
        </form>
    </div>

<link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript">
</script> <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function() {
            {% if client %}
                $("#autocomplete-clients").val('{{ client.name }}');
                $("select[name='clientID']").val({{ client.id }});
            {% endif %}
          $("#autocomplete-clients").autocomplete({
                source: "/api/clients/",
                minLength: 1,
                select: function(event, ui) {
                            event.preventDefault();
                            if(ui.item.value == 0){
                                window.location.href = '../../clients/new';
                            }
                            else{
                                $("#autocomplete-clients").val(ui.item.label.substring(ui.item.label.indexOf('-')+2));
                                $("select[name='clientID']").val(ui.item.value);
                            }

                        }
          });

        });

    //   keeps same width as box
      jQuery.ui.autocomplete.prototype._resizeMenu = function () {
          var ul = this.menu.element;
          ul.outerWidth(this.element.outerWidth());
        }
</script>

{% endblock %}